# GX Works2 模擬器設定指南

## 問題診斷結果
✅ TCP 連線成功 (127.0.0.1:5007)
❌ MC Protocol 通訊失敗 (所有暫存器讀取都超時)

## 原因分析
模擬器雖然在監聽埠號，但沒有正確處理 MC Protocol 請求。

## 解決步驟

### 1. 確認 GX Works2 模擬器狀態
- [ ] 模擬器是否已啟動並運行中
- [ ] CPU 模組是否為 RUN 狀態（綠燈）
- [ ] 是否有錯誤指示燈亮起

### 2. 檢查 MC Protocol 設定
在 GX Works2 中：
1. 開啟「專案」→「參數」→「PLC參數」
2. 找到「內建乙太網路」或「網路」設定
3. 確認 MC Protocol 設定：
   - ✅ 啟用 MC Protocol
   - ✅ 埠號設定為 5007
   - ✅ 通訊格式設定為 Binary

### 3. 檢查防火牆設定
- [ ] Windows 防火牆是否阻擋了連線
- [ ] 防毒軟體是否干擾通訊

### 4. 替代測試方法
如果模擬器設定有問題，可以嘗試：
1. 使用真實的三菱 PLC
2. 使用其他 PLC 模擬軟體
3. 檢查是否有其他 MC Protocol 測試工具

### 5. 偵錯建議
- 使用網路封包分析工具（如 Wireshark）檢查通訊封包
- 確認模擬器版本是否支援 MC Protocol
- 檢查 GX Works2 說明文件中的通訊設定章節

## 常見解決方案
1. **重新啟動模擬器**：關閉並重新開啟 GX Works2 模擬器
2. **檢查專案設定**：確保專案中的 CPU 類型支援 MC Protocol
3. **更新軟體版本**：確保使用最新版本的 GX Works2

## 測試確認
設定完成後，執行以下指令確認：
```bash
python mc1_fixed.py
```

如果看到類似以下輸出表示成功：
```
✅ 連線成功！
✅ D0 讀取成功: [0]
✅ 找到可用的暫存器位址: D0
```
